{% extends "portal/layout.html" %}
{% set title = _('Perguntas') %}

{% block portal_content %}
  <div class="box">
    <h3>{{ question.name }}</h3>
    <p><strong>Fonte:</strong> {{ source.name }} ({{ source.type }})</p>
    <p><strong>SQL:</strong></p>
    <pre style="white-space: pre-wrap;">{{ question.sql_text }}</pre>

    <p>
      <a class="button" href="{{ url_for('portal.questions_viz', question_id=question.id) }}">{{ _('Configurar visualização') }}</a>
    </p>
    <form method="post" action="{{ url_for('portal.questions_run', question_id=question.id) }}">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
      <label style="margin-top:.8em;">{{ _('Parâmetros (JSON)') }}</label>
      <textarea name="params_json" rows="4" placeholder='{"start_date": "2026-01-01"}'></textarea>
      <button type="submit" class="button primary">{{ _('Executar') }}</button>
      <a class="button" href="{{ url_for('portal.questions_list') }}">{{ _('Voltar') }}</a>
    </form>
  </div>
{% endblock %}
