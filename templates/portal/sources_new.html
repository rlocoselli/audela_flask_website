{% extends "portal/layout.html" %}
{% set title = "Nova fonte" %}

{% block portal_content %}
  <div class="box">
    <form method="post">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />

      <div class="row gtr-uniform gtr-50">
        <div class="col-6 col-12-xsmall">
          <label>Nome</label>
          <input type="text" name="name" placeholder="Ex.: DW Produção" required />
        </div>
        <div class="col-6 col-12-xsmall">
          <label>Tipo</label>
          <select name="type" required>
            <option value="postgres">PostgreSQL</option>
            <option value="mysql">MySQL/MariaDB</option>
            <option value="sqlserver">SQL Server</option>
            <option value="oracle">Oracle</option>
            <option value="sqlite">SQLite</option>
          </select>
        </div>
        <div class="col-12">
          <label>URL de conexão (SQLAlchemy)</label>
          <input type="text" name="url" placeholder="Ex.: postgresql+psycopg://user:pass@host:5432/dbname" required />
          <p style="margin: .4em 0 0 0; font-size: .9em;">Dica: para SQLite local: <code>sqlite:////caminho/arquivo.db</code></p>
        </div>
        <div class="col-6 col-12-xsmall">
          <label>Schema padrão (opcional)</label>
          <input type="text" name="default_schema" placeholder="public" />
        </div>
        <div class="col-6 col-12-xsmall">
          <label>Coluna tenant (opcional)</label>
          <input type="text" name="tenant_column" placeholder="tenant_id" />
          <p style="margin: .4em 0 0 0; font-size: .9em;">Se preenchida, o sistema exige <code>:tenant_id</code> no SQL.</p>
        </div>
        <div class="col-12">
          <button class="button primary" type="submit">Salvar</button>
          <a class="button" href="{{ url_for('portal.sources_list') }}">Cancelar</a>
        </div>
      </div>
    </form>
  </div>
{% endblock %}
